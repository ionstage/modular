!function t(e,n,o){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return r(n?n:t)},h,h.exports,t,e,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(t,e,n){!function(e){"use strict";var n=e.dom||t("./dom.js"),o=e.Body||t("./components/body.js");e.body=new o;var r=n.global();r.app||(r.app={})}(this.app||(this.app={}))},{"./components/body.js":2,"./dom.js":14}],2:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.Component||t("./component.js"),s=n.Content||t("./content.js"),a=n.Sidebar||t("./sidebar.js"),l=function(t){this.packageName=t.packageName||"",this.label=t.label||"",this.description=t.description||"",this.src=t.src||"",this.visiblePortNames=t.visiblePortNames||[],this.tags=t.tags||[]};l.prototype.key=function(){return this.packageName+"/"+this.src},l.prototype.keywordScore=function(t){if(!t)return 0;t=t.toLowerCase();var e=this.label.toLowerCase();if(0===e.indexOf(t))return 1;for(var n=this.tags,o=0,r=n.length;r>o;o++){var i=n[o].toLowerCase();if(-1!==i.indexOf(t))return.75}if(t.length<2)return 0;if(-1!==e.indexOf(t))return.5;var s=this.description.toLowerCase();return-1!==s.indexOf(t)?.25:0};var p=function(){this.data={}};p.prototype.packageNamesUrl=function(){return"modular_modules/index.json"},p.prototype.moduleEntriesUrl=function(t){return["modular_modules/",t.split("/").map(function(t){return encodeURIComponent(t)}).join("/"),"/index.json"].join("")},p.prototype.load=function(){return this.loadPackageNames().then(function(t){return Promise.all(t.map(function(t){return this.loadModuleEntries(t).then(function(t){t.forEach(function(t){this.data[t.key()]=t}.bind(this))}.bind(this))}.bind(this)))}.bind(this))},p.prototype.loadPackageNames=function(){return r.ajax({type:"GET",url:this.packageNamesUrl()}).then(function(t){return JSON.parse(t)})},p.prototype.loadModuleEntries=function(t){return r.ajax({type:"GET",url:this.moduleEntriesUrl(t)}).then(function(e){return JSON.parse(e).map(function(e){return new l(o.extend(o.clone(e),{packageName:t}))})})},p.prototype.get=function(t){return this.data[t]||null},p.prototype.search=function(t){return o.sortBy(o.values(this.data).filter(function(e){return 0!==e.keywordScore(t)}),function(e){return-e.keywordScore(t)})};var h=o.inherits(function(){h.super_.call(this,{element:r.body()}),this.dragCount=this.prop(0),this.moduleEntryCollection=new p,this.content=new s({element:r.el(".content"),sidebarCollapser:h.prototype.sidebarCollapser.bind(this),sidebarExpander:h.prototype.sidebarExpander.bind(this),moduleDragStarter:h.prototype.moduleDragStarter.bind(this),moduleDragEnder:h.prototype.moduleDragEnder.bind(this)}),this.sidebar=new a({element:r.el(".sidebar"),moduleDragStarter:h.prototype.moduleDragStarter.bind(this),moduleDragEnder:h.prototype.moduleDragEnder.bind(this),moduleDropper:h.prototype.moduleDropper.bind(this),moduleEntrySearcher:h.prototype.moduleEntrySearcher.bind(this)}),r.ready(h.prototype.onready.bind(this))},i);h.prototype.incrementDragCount=function(){this.dragCount(this.dragCount()+1)},h.prototype.decrementDragCount=function(){this.dragCount(this.dragCount()-1)},h.prototype.redraw=function(){this.redrawDragCount()},h.prototype.redrawDragCount=function(){var t=this.dragCount(),e=this.cache();t!==e.dragCount&&(r.toggleClass(this.element(),"module-dragging",t>0),e.dragCount=t)},h.prototype.onready=function(){this.content.redraw(),this.moduleEntryCollection.load().then(function(){this.sidebar.searchEnabled(!0)}.bind(this))},h.prototype.sidebarCollapser=function(){return r.transition(this.element(),function(){r.addClass(this.element(),"no-sidebar")}.bind(this))},h.prototype.sidebarExpander=function(){return r.transition(this.element(),function(){r.removeClass(this.element(),"no-sidebar")}.bind(this))},h.prototype.moduleDragStarter=function(){this.incrementDragCount()},h.prototype.moduleDragEnder=function(){this.decrementDragCount()},h.prototype.moduleDropper=function(t,e,n){var o=this.moduleEntryCollection.get(t);this.content.loadModuleByClientPosition({title:o.label,name:t,x:e,y:n},o.visiblePortNames)},h.prototype.moduleEntrySearcher=function(t){return this.moduleEntryCollection.search(t)},"undefined"!=typeof e&&e.exports?e.exports=h:n.Body=h}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"./component.js":4,"./content.js":6,"./sidebar.js":13}],3:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.Component||t("./component.js"),s=o.inherits(function(t){s.super_.call(this,t),this.isActive=this.prop(!1),this.disabled=this.prop(!1),this.registerTapListener()},i);s.prototype.registerTapListener=function(){var t;new r.Draggable({element:this.element(),onstart:function(e,n,o){t=r.target(o),r.cancel(o),r.removeFocus(),this.isActive(!0)}.bind(this),onmove:function(e,n,o){this.isActive(r.target(o)===t)}.bind(this),onend:function(e,n,o){this.isActive(!1),r.target(o)===t&&this.ontap()}.bind(this)})},s.prototype.redraw=function(){this.redrawToggleClass("isActive","active"),this.redrawToggleClass("disabled","disabled")},s.prototype.ontap=function(){},"undefined"!=typeof e&&e.exports?e.exports=s:n.Button=s}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"./component.js":4}],4:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),r=n.helper||t("../helper.js"),i=n.dom||t("../dom.js"),s=r.inherits(function(t){s.super_.call(this),this.element=this.prop(t.element),this.cache=this.prop({})},o.Component);s.prototype.needsUpdate=function(t){return t.some(function(t){var e=this.cache(),n=this[t]();return!r.equal(n,e[t])}.bind(this))},s.prototype.values=function(t){return t.map(function(t){return this[t]()}.bind(this))},s.prototype.updateCache=function(t){t.forEach(function(t){var e=this.cache(),n=this[t]();e[t]=n}.bind(this))},s.prototype.redrawProp=function(){var t=Array.prototype.slice.call(arguments),e=t.pop();this.needsUpdate(t)&&(e.apply(this,this.values(t)),this.updateCache(t))},s.prototype.redrawToggleClass=function(t,e){this.redrawProp(t,function(t){i.toggleClass(this.element(),e,t)})},"undefined"!=typeof e&&e.exports?e.exports=s:n.Component=s}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,jcore:void 0}],5:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.Button||t("./button.js"),s=n.Component||t("./component.js"),a=n.SidebarToggleButton||t("./sidebar-toggle-button.js"),l=o.inherits(function(t){l.super_.call(this,t),this.loader=t.loader,this.registerChangeListener()},i);l.prototype.inputElement=function(){return r.child(this.element(),0)},l.prototype.registerChangeListener=function(){r.on(this.inputElement(),"change",function(t){this.loader(t.target.files[0]),r.value(this.inputElement(),"")}.bind(this))},l.prototype.ontap=function(){r.supportsTouch()&&this.inputElement().click()};var p=o.inherits(function(t){p.super_.call(this,t),this.saver=t.saver},i);p.prototype.ontap=function(){this.saver()};var h=o.inherits(function(t){h.super_.call(this,t),this.disabled=this.prop(!1),this.sidebarToggleButton=new a({element:this.sidebarToggleButtonElement(),collapser:t.sidebarCollapser,expander:t.sidebarExpander}),this.loadButton=new l({element:this.loadButtonElement(),loader:t.fileLoader}),this.saveButton=new p({element:this.saveButtonElement(),saver:t.fileSaver})},s);h.prototype.sidebarToggleButtonElement=function(){return r.child(this.element(),0)},h.prototype.loadButtonElement=function(){return r.child(this.element(),1)},h.prototype.saveButtonElement=function(){return r.child(this.element(),2)},h.prototype.redraw=function(){this.sidebarToggleButton.redraw(),this.redrawToggleClass("disabled","disabled")},"undefined"!=typeof e&&e.exports?e.exports=h:n.ContentHeader=h}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"./button.js":3,"./component.js":4,"./sidebar-toggle-button.js":12}],6:[function(t,e,n){!function(n){"use strict";var o=t("file-saver"),r=n.helper||t("../helper.js"),i=n.dom||t("../dom.js"),s=n.Component||t("./component.js"),a=n.ContentHeader||t("./content-header.js"),l=n.ModuleContainer||t("./module-container.js"),p=r.inherits(function(t){p.super_.call(this,t),this.header=new a({element:this.headerElement(),sidebarCollapser:t.sidebarCollapser,sidebarExpander:t.sidebarExpander,fileLoader:p.prototype.fileLoader.bind(this),fileSaver:p.prototype.fileSaver.bind(this)}),this.moduleContainer=new l({element:this.moduleContainerElement(),moduleDragStarter:t.moduleDragStarter,moduleDragEnder:t.moduleDragEnder})},s);p.prototype.headerElement=function(){return i.child(this.element(),0)},p.prototype.moduleContainerElement=function(){return i.child(this.element(),1)},p.prototype.disabled=function(t){this.header.disabled(t),this.moduleContainer.disabled(t)},p.prototype.loadModuleByClientPosition=function(t,e){return this.moduleContainer.loadModuleByClientPosition(t,e)["catch"](function(t){if(!(t instanceof RangeError))throw t})},p.prototype.redraw=function(){this.header.redraw(),this.moduleContainer.redraw()},p.prototype.fileLoader=function(t){this.disabled(!0),i.load(t).then(function(t){var e=JSON.parse(t);this.moduleContainer.clear(),this.moduleContainer.load(e)}.bind(this))["catch"](function(t){alert(t)}).then(function(){this.disabled(!1)}.bind(this))},p.prototype.fileSaver=function(){var t=JSON.stringify(this.moduleContainer.toData()),e=new Blob([t],{type:"application/json"});o.saveAs(e,"download.json")},"undefined"!=typeof e&&e.exports?e.exports=p:n.Content=p}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"./component.js":4,"./content-header.js":5,"./module-container.js":7,"file-saver":void 0}],7:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.CircuitElement||t("../models/circuit-element.js"),s=n.Component||t("./component.js"),a=n.LockRelation||t("../relations/lock-relation.js"),l=n.Module||t("./module.js"),p=n.ModuleUnit||t("../models/module-unit.js"),h=n.ModuleWire||t("./module-wire.js"),u=function(){this.data=new o.Map};u.prototype.add=function(t){var e=this.data,n=new a(t);e.has(n)||(t.unit.addRelation(n),e.set(n,n))},u.prototype.remove=function(t){var e=this.data,n=e.get(new a(t));n&&(t.unit.removeRelation(n),e["delete"](n))},u.prototype.filter=function(t){var e=[];return this.data.forEach(function(n){var r=Object.keys(t).every(function(e){return o.equal(n[e],t[e])});r&&e.push(n)}),e};var d=function(t){this.sourceUnit=t.sourceUnit,this.targetUnit=t.targetUnit};d.prototype.equal=function(t){return t?Object.keys(this).every(function(e){return o.equal(this[e],t[e])}.bind(this)):!1},d.prototype.source=function(){return this.sourceUnit.circuitElementMember()},d.prototype.target=function(){return this.targetUnit.circuitElementMember()},d.prototype.bind=function(){i.bind(this.source(),this.target())},d.prototype.unbind=function(){i.unbind(this.source(),this.target())};var c=function(){this.data=new o.Set};c.prototype.toArray=function(){return this.data.toArray()},c.prototype.add=function(t){var e=this.data,n=new d(t);e.has(n)||(n.bind(),e.add(n))},c.prototype.remove=function(t){var e=this.data,n=new d(t);e.has(n)&&(n.unbind(),e["delete"](n))};var f=o.inherits(function(t){f.super_.call(this,t),this.modules=this.prop([]),this.disabled=this.prop(!1),this.draggingWires=this.prop([]),this.lockRelationCollection=new u,this.bindingCollection=new c,this.deleter=f.prototype.deleter.bind(this),this.fronter=f.prototype.fronter.bind(this),this.portToggler=f.prototype.portToggler.bind(this),this.portEventer=f.prototype.portEventer.bind(this),this.dragStarter=f.prototype.dragStarter.bind(this),this.dragEnder=f.prototype.dragEnder.bind(this),this.dragPortPlugStarter=f.prototype.dragPortPlugStarter.bind(this),this.dragPortPlugMover=f.prototype.dragPortPlugMover.bind(this),this.dragPortPlugEnder=f.prototype.dragPortPlugEnder.bind(this),this.dragPortSocketStarter=f.prototype.dragPortSocketStarter.bind(this),this.dragPortSocketMover=f.prototype.dragPortSocketMover.bind(this),this.dragPortSocketEnder=f.prototype.dragPortSocketEnder.bind(this),this.moduleDragStarter=t.moduleDragStarter,this.moduleDragEnder=t.moduleDragEnder,r.on(this.element(),r.eventType("start"),f.prototype.onpoint.bind(this))},s);f.prototype.retainerElement=function(){return r.child(this.element(),0)},f.prototype.wireContainerElement=function(){return r.child(this.element(),1)},f.prototype.contentElement=function(){return r.child(this.element(),2)},f.prototype.wireHandleContainerElement=function(){return r.child(this.element(),3)},f.prototype.clientPosition=function(){var t=r.rect(this.element());return new r.Point({x:t.left,y:t.top})},f.prototype.scrollLeft=function(){return r.scrollLeft(this.element())},f.prototype.scrollTop=function(){return r.scrollTop(this.element())},f.prototype.localPoint=function(t){var e=this.clientPosition();return new r.Point({x:t.x-e.x+this.scrollLeft(),y:t.y-e.y+this.scrollTop()})},f.prototype.diagonalPoint=function(){var t=new r.Point({x:0,y:0});return this.modules().forEach(function(e){var n=e.diagonalPoint();t.x=Math.max(n.x,t.x),t.y=Math.max(n.y,t.y)}),t},f.prototype.lockedWires=function(t,e){return this.lockRelationCollection.filter({type:t,unit:e}).map(function(t){return t.wire})},f.prototype.attachedWire=function(t){return this.lockedWires(f.LOCK_TYPE_SOCKET,t)[0]},f.prototype.bindings=function(){return this.bindingCollection.toArray()},f.prototype.connectedTargetUnits=function(t){return this.bindings().filter(function(e){return o.equal(e.sourceUnit,t)}).map(function(t){return t.targetUnit})},f.prototype.connectedSourceUnit=function(t){return this.bindings().filter(function(e){return o.equal(e.targetUnit,t)}).map(function(t){return t.sourceUnit})[0]||null},f.prototype.unitFromSocketPosition=function(t,e){for(var n=this.modules(),o=n.length-1;o>=0;o--)for(var r=n[o],i=r.ports(),s=i.length-1;s>=0;s--){var a=i[s],l=r.socketPosition(a);if(Math.abs(t-l.x)>18)break;if(!(Math.abs(e-l.y)>18)&&a.visible()&&!a.socketDisabled())return new p({module:r,port:a})}return null},f.prototype.toData=function(){return{modules:this.toModulesData(),connections:this.toConnectionsData(this.modules())}},f.prototype.toModulesData=function(){return this.modules().map(function(t){return{props:t.props(),visiblePortNames:t.visiblePortNames()}})},f.prototype.toConnectionsData=function(t){return this.bindings().map(function(e){var n=e.sourceUnit,r=e.targetUnit,i=o.findIndex(t,function(t){return n.contains(t)}),s=o.findIndex(t,function(t){return r.contains(t)});return{source:{moduleIndex:i,portName:n.portName()},target:{moduleIndex:s,portName:r.portName()}}})},f.prototype.load=function(t){return this.loadModules(t.modules).then(function(e){return this.loadConnections(t.connections,e)}.bind(this))},f.prototype.loadModules=function(t){return Promise.all(t.map(function(t){return this.loadModule(t.props,t.visiblePortNames)}.bind(this)))},f.prototype.loadConnections=function(t,e){return Promise.all(t.map(function(t){var n=t.source,o=t.target,r={source:p.fromModuleAndPortName(e[n.moduleIndex],n.portName),target:p.fromModuleAndPortName(e[o.moduleIndex],o.portName)};if(!this.canConnect(r.source,r.target))throw new Error("Invalid connection");return r}.bind(this))).then(function(t){t.forEach(function(t){this.connect(t.source,t.target)}.bind(this))}.bind(this))},f.prototype.clear=function(){this.modules().slice().forEach(function(t){t["delete"]()})},f.prototype.createModule=function(t){return new l(o.extend(o.clone(t),{parentElement:this.contentElement(),deleter:this.deleter,fronter:this.fronter,portToggler:this.portToggler,portEventer:this.portEventer,dragStarter:this.dragStarter,dragEnder:this.dragEnder,dragPortPlugStarter:this.dragPortPlugStarter,dragPortPlugMover:this.dragPortPlugMover,dragPortPlugEnder:this.dragPortPlugEnder,dragPortSocketStarter:this.dragPortSocketStarter,dragPortSocketMover:this.dragPortSocketMover,dragPortSocketEnder:this.dragPortSocketEnder}))},f.prototype.createConnectingWire=function(t,e){var n=t.plugPosition(),o=e.socketPosition();return new h({sourceX:n.x,sourceY:n.y,targetX:o.x,targetY:o.y,handleType:t.portType(),handleVisible:!1,parentElement:this.wireContainerElement(),parentHandleElement:this.wireHandleContainerElement()})},f.prototype.createDraggingWire=function(t){var e=t.plugPosition();return new h({sourceX:e.x,sourceY:e.y,targetX:e.x,targetY:e.y,handleType:t.portType(),handleVisible:!0,parentElement:this.wireContainerElement(),parentHandleElement:this.wireHandleContainerElement()})},f.prototype.loadModule=function(t,e){var n=this.createModule(t);return this.modules().push(n),this.updateZIndex(),this.updateWireHandleContainer(),n.redraw(),n.loadComponent().then(function(){return e.forEach(function(t){n.showPort(t)}),n})},f.prototype.loadModuleByClientPosition=function(t,e){var n=this.localPoint(o.pick(t,["x","y"]));return n.x<0||n.y<0?Promise.reject(new RangeError("Invalid position")):this.loadModule(o.extend(o.clone(t),n),e)},f.prototype.lock=function(t,e,n){this.lockRelationCollection.add({type:t,unit:e,wire:n})},f.prototype.unlock=function(t,e,n){this.lockRelationCollection.remove({type:t,unit:e,wire:n})},f.prototype.bind=function(t,e){this.bindingCollection.add({sourceUnit:t,targetUnit:e})},f.prototype.unbind=function(t,e){this.bindingCollection.remove({sourceUnit:t,targetUnit:e})},f.prototype.canConnect=function(t,e){return t&&e?t.portType()!==e.portType()?!1:t.portPlugDisabled()||e.portSocketDisabled()?!1:t.portVisible()&&e.portVisible()?!e.portSocketConnected():!1:!1},f.prototype.connect=function(t,e){var n=this.createConnectingWire(t,e);n.markDirty(),e.portSocketConnected(!0),this.bind(t,e),this.lock(f.LOCK_TYPE_PLUG,t,n),this.lock(f.LOCK_TYPE_SOCKET,e,n),this.updateEventHighlight(t)},f.prototype.disconnect=function(t,e){var n=this.attachedWire(e);n.parentElement(null),e.portSocketConnected(!1),this.unbind(t,e),this.unlock(f.LOCK_TYPE_PLUG,t,n),this.unlock(f.LOCK_TYPE_SOCKET,e,n),e.portSocketHighlighted(!1)},f.prototype.disconnectAll=function(t){this.bindings().forEach(function(e){(o.equal(e.sourceUnit,t)||o.equal(e.targetUnit,t))&&this.disconnect(e.sourceUnit,e.targetUnit)}.bind(this))},f.prototype.appendDraggingWire=function(t,e){this.lock(f.LOCK_TYPE_PLUG,t,e),this.updateEventHighlight(t),this.draggingWires().push(e),this.updateDragHighlight(t)},f.prototype.attachDraggingWire=function(t,e,n){n.handleVisible(!1),e.portSocketConnected(!0),this.bind(t,e),this.lock(f.LOCK_TYPE_SOCKET,e,n),this.updateEventHighlight(t),this.updateDragHighlight(e)},f.prototype.detachDraggingWire=function(t,e,n){n.handleVisible(!0),e.portSocketConnected(!1),this.unbind(t,e),this.unlock(f.LOCK_TYPE_SOCKET,e,n),e.portSocketHighlighted(!1),this.updateDragHighlight(e)},f.prototype.removeDraggingWire=function(t,e,n){o.remove(this.draggingWires(),n),this.updateDragHighlight(t),e?this.updateDragHighlight(e):(this.unlock(f.LOCK_TYPE_PLUG,t,n),n.parentElement(null))},f.prototype.updateRetainer=function(){this.markDirty()},f.prototype.updateWireHandleContainer=function(){this.markDirty()},f.prototype.updateZIndex=function(){this.modules().forEach(function(t,e){t.zIndex(e)})},f.prototype.updateEventHighlight=function(t){var e=t.portPlugHighlighted();this.connectedTargetUnits(t).forEach(function(t){t.portSocketHighlighted(e)}),this.lockedWires(f.LOCK_TYPE_PLUG,t).forEach(function(t){t.highlighted(e)})},f.prototype.updateDragHighlight=function(t){var e=this.draggingWires(),n=this.lockRelationCollection.filter({unit:t}).some(function(t){return-1!==e.indexOf(t.wire)});t.labelHighlighted(n)},f.prototype.redraw=function(){this.redrawToggleClass("disabled","disabled"),this.redrawRetainer(),this.redrawWireHandleContainer()},f.prototype.redrawRetainer=function(){var t=this.diagonalPoint(),e=t.x-1+f.RETAINER_PADDING,n=t.y-1+f.RETAINER_PADDING,o=this.cache();e===o.retainerX&&n===o.retainerY||(r.translate(this.retainerElement(),e,n),o.retainerX=e,o.retainerY=n)},f.prototype.redrawWireHandleContainer=function(){var t=this.modules().length+1,e=this.cache();t!==e.zIndex&&(r.css(this.wireHandleContainerElement(),{zIndex:t}),e.zIndex=t)},f.prototype.onpoint=function(t){r.target(t)===this.element()&&r.removeFocus()},f.prototype.deleter=function(t){var e=this.modules();-1!==e.indexOf(t)&&(o.remove(e,t),this.updateZIndex(),this.updateWireHandleContainer())},f.prototype.fronter=function(t){o.moveToBack(this.modules(),t),this.updateZIndex()},f.prototype.portToggler=function(t){t.portVisible()||this.disconnectAll(t),this.updateRetainer()},f.prototype.portEventer=function(t){t.portPlugHighlighted(!0),this.updateEventHighlight(t),setTimeout(function(){t.portPlugHighlighted(!1),this.updateEventHighlight(t)}.bind(this),100)},f.prototype.dragStarter=function(){this.updateRetainer(),this.moduleDragStarter()},f.prototype.dragEnder=function(){this.updateRetainer(),this.moduleDragEnder()},f.prototype.dragPortPlugStarter=function(t,e){var n=this.createDraggingWire(t);n.markDirty(),this.appendDraggingWire(t,n);var o=t.plugPosition();e.x=o.x,e.y=o.y,e.wire=n,e.targetUnit=null},f.prototype.dragPortPlugMover=function(t,e,n,r){var i=r.x+e,s=r.y+n,a=r.targetUnit,l=this.unitFromSocketPosition(i,s);if(!l||!o.equal(l,a)){var p=r.wire;p.targetX(i),p.targetY(s),a&&this.detachDraggingWire(t,a,p);var h=this.canConnect(t,l)?l:null;h&&this.attachDraggingWire(t,h,p),r.targetUnit=h}},f.prototype.dragPortPlugEnder=function(t,e){this.removeDraggingWire(t,e.targetUnit,e.wire)},f.prototype.dragPortSocketStarter=function(t,e){var n=this.attachedWire(t),o=this.connectedSourceUnit(t);this.draggingWires().push(n),this.updateDragHighlight(o),this.updateDragHighlight(t),e.x=n.targetX(),e.y=n.targetY(),e.wire=n,e.sourceUnit=o,e.targetUnit=t},f.prototype.dragPortSocketMover=function(t,e,n,o){this.dragPortPlugMover(o.sourceUnit,e,n,o)},f.prototype.dragPortSocketEnder=function(t,e){this.dragPortPlugEnder(e.sourceUnit,e)},f.LOCK_TYPE_PLUG=a.TYPE_PLUG,f.LOCK_TYPE_SOCKET=a.TYPE_SOCKET,f.RETAINER_PADDING=80,"undefined"!=typeof e&&e.exports?e.exports=f:n.ModuleContainer=f}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"../models/circuit-element.js":16,"../models/module-unit.js":17,"../relations/lock-relation.js":18,"./component.js":4,"./module-wire.js":9,"./module.js":10}],8:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.Component||t("./component.js"),s=o.inherits(function(t){s.super_.call(this,t),this.label=this.prop(t.label),this.name=this.prop(t.name),this.type=this.prop(t.type),this.plugDisabled=this.prop(t.plugDisabled),this.socketDisabled=this.prop(t.socketDisabled),this.visible=this.prop(!1),this.top=this.prop(0),this.height=this.prop(44),this.socketConnected=this.prop(!1),this.labelHighlighted=this.prop(!1),this.plugHighlighted=this.prop(!1),this.socketHighlighted=this.prop(!1),this.isMoving=this.prop(!1),this.listItemElement=this.prop(this.renderListItem()),this.parentListElement=this.prop(t.parentListElement),this.optionElement=this.prop(this.renderOption()),this.parentOptGroupElement=this.prop(t.parentOptGroupElement),this.element=this.listItemElement},i);s.prototype.hideDisabled=function(){return this.labelHighlighted()},s.prototype.middle=function(){return this.top()+this.height()/2},s.prototype.bottom=function(){return this.top()+this.height()},s.prototype.renderListItem=function(){var t=r.el("<div>");r.addClass(t,"module-port"),r.data(t,"type",this.type()),r.html(t,(this.plugDisabled()?"":'<div class="module-port-plug"></div>')+(this.socketDisabled()?"":'<div class="module-port-socket"><span></span></div>')+'<div class="module-port-label"></div><img class="module-port-hide-button" src="images/minus-square-o.svg">');var e=r.children(t);return r.text(e[e.length-2],this.label()),t},s.prototype.renderOption=function(){var t=r.el("<option>");return r.text(t,this.label()),r.value(t,this.name()),t},s.prototype.redraw=function(){this.redrawVisibility(),this.redrawPosition(),this.redrawToggleClasses()},s.prototype.redrawVisibility=function(){var t=this.visible(),e=this.cache();t!==e.visible&&(t?(r.remove(this.optionElement()),r.append(this.parentListElement(),this.listItemElement())):(r.remove(this.listItemElement()),r.append(this.parentOptGroupElement(),this.optionElement())),e.visible=t)},s.prototype.redrawPosition=function(){var t=this.top(),e=this.cache();t!==e.top&&(r.translateY(this.listItemElement(),t),e.top=t)},s.prototype.redrawToggleClasses=function(){this.redrawToggleClass("socketConnected","module-port-socket-connected"),this.redrawToggleClass("labelHighlighted","module-port-label-highlight"),this.redrawToggleClass("plugHighlighted","module-port-plug-highlight"),this.redrawToggleClass("socketHighlighted","module-port-socket-highlight"),this.redrawToggleClass("isMoving","module-port-moving"),this.redrawToggleClass("hideDisabled","module-port-hide-disabled")},s.TYPE_PROP="prop",s.TYPE_EVENT="event",s.PLUG_OFFSET_X=261,s.PLUG_WIDTH=50,s.SOCKET_OFFSET_X=-25,s.SOCKET_WIDTH=50,"undefined"!=typeof e&&e.exports?e.exports=s:n.ModulePort=s}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"./component.js":4}],9:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.Component||t("./component.js"),s=o.inherits(function(t){s.super_.call(this,t),this.sourceX=this.prop(t.sourceX),this.sourceY=this.prop(t.sourceY),this.targetX=this.prop(t.targetX),this.targetY=this.prop(t.targetY),this.handleType=this.prop(t.handleType),this.handleVisible=this.prop(t.handleVisible),this.highlighted=this.prop(!1),this.parentElement=this.prop(t.parentElement),this.handleElement=this.prop(null),this.parentHandleElement=this.prop(t.parentHandleElement)},i);s.prototype.pathElement=function(){return r.childNode(this.element(),0,0)},s.prototype.renderWire=function(){var t=r.el("<div>");return r.addClass(t,"module-wire"),r.html(t,s.TEMPLATE_HTML),t},s.prototype.renderHandle=function(){var t=r.el("<div>");return r.addClass(t,"module-wire-handle"),t},s.prototype.redraw=function(){var t=this.element(),e=this.parentElement();if(e||t){if(e&&!t)return this.element(this.renderWire()),this.handleElement(this.renderHandle()),this.redraw(),r.append(e,this.element()),void r.append(this.parentHandleElement(),this.handleElement());if(!e&&t)return r.remove(t),r.remove(this.handleElement()),this.element(null),this.handleElement(null),void this.cache({});this.redrawWire(),this.redrawHandle()}},s.prototype.redrawWire=function(){var t=this.cache(),e=this.highlighted();e!==t.highlighted&&r.toggleClass(this.element(),"module-wire-highlight",e);var n=this.sourceX(),o=this.sourceY(),i=this.targetX(),s=this.targetY();if(n!==t.sourceX||o!==t.sourceY||i!==t.targetX||s!==t.targetY){var a=Math.min(n,i),l=Math.min(o,s);r.translate(this.element(),a,l),r.attr(this.pathElement(),{d:["M",n-a,o-l,"L",i-a,s-l].join(" ")}),t.sourceX=n,t.sourceY=o,t.targetX=i,t.targetY=s}},s.prototype.redrawHandle=function(){var t=this.cache(),e=this.handleType();e!==t.handleType&&(r.data(this.handleElement(),"type",e),t.handleType=e);var n=this.handleVisible();n!==t.handleVisible&&(r.toggleClass(this.handleElement(),"hide",!n),t.handleVisible=n);var o=this.highlighted();o!==t.highlighted&&(r.toggleClass(this.handleElement(),"module-wire-highlight",o),t.highlighted=o);var i=t.targetX-s.HANDLE_WIDTH/2,a=t.targetY-s.HANDLE_WIDTH/2;i===t.x&&a===t.y||(r.translate(this.handleElement(),i,a),t.x=i,t.y=a)},s.TEMPLATE_HTML=['<svg class="module-wire-path-container">','<path class="module-wire-path"></path>',"</svg>"].join(""),s.HANDLE_WIDTH=24,"undefined"!=typeof e&&e.exports?e.exports=s:n.ModuleWire=s}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"./component.js":4}],10:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.CircuitElement||t("../models/circuit-element.js"),s=n.Component||t("./component.js"),a=n.ModulePort||t("./module-port.js"),l=n.ModuleUnit||t("../models/module-unit.js"),p=o.inherits(function(t){p.super_.call(this,t),this.title=this.prop(t.title),this.name=this.prop(t.name),this.x=this.prop(t.x),this.y=this.prop(t.y),this.zIndex=this.prop("auto"),this.deletable=this.prop(!0),this.ports=this.prop([]),this.portListTop=this.prop(0),this.portListHeight=this.prop(0),this.eventCircuitElement=this.prop(null),this.messageData=this.prop(o.randomString(7)),this.isLoading=this.prop(!1),this.isError=this.prop(!1),this.isMoving=this.prop(!1),this.isDeleting=this.prop(!1),this.parentElement=this.prop(t.parentElement),this.messageListenable=new r.Listenable({callback:p.prototype.onmessage.bind(this)}),this.draggable=null,this.onchange=p.prototype.onchange.bind(this),this.onpoint=p.prototype.onpoint.bind(this),this.deleter=t.deleter,this.fronter=t.fronter,this.portToggler=t.portToggler,this.portEventer=t.portEventer,this.dragStarter=t.dragStarter,this.dragEnder=t.dragEnder,this.dragPortPlugStarter=t.dragPortPlugStarter,this.dragPortPlugMover=t.dragPortPlugMover,this.dragPortPlugEnder=t.dragPortPlugEnder,this.dragPortSocketStarter=t.dragPortSocketStarter,this.dragPortSocketMover=t.dragPortSocketMover,this.dragPortSocketEnder=t.dragPortSocketEnder},s);p.prototype.headerElement=function(){return r.child(this.element(),0)},p.prototype.titleElement=function(){return r.child(this.element(),0,0)},p.prototype.deleteButtonElement=function(){return r.child(this.element(),0,1)},p.prototype.componentElement=function(){return r.child(this.element(),1,0)},p.prototype.portListElement=function(){return r.child(this.element(),1,1)},p.prototype.footerElement=function(){return r.child(this.element(),2)},p.prototype.portSelectElement=function(){return r.child(this.element(),2,1)},p.prototype.portOptGroupElement=function(){var t={prop:0,event:1};return function(e){return r.child(this.element(),2,1,t[e])}}(),p.prototype.componentContentWindow=function(){return r.contentWindow(this.componentElement())},p.prototype.circuitElement=function(){return o.dig(this.componentContentWindow(),"modular","exports")},p.prototype.circuitElementMember=function(t){var e=this.circuitElement();return e?e.get(t):null},p.prototype.diagonalPoint=function(){var t=r.rect(this.element());return new r.Point({x:this.x()+t.width+(this.hasVisiblePortPlug()?a.PLUG_WIDTH:0),y:this.y()+t.height})},p.prototype.hasVisiblePortPlug=function(){return this.visiblePorts().some(function(t){return!t.plugDisabled()})},p.prototype.hasVisiblePortSocket=function(){return this.visiblePorts().some(function(t){return!t.socketDisabled()})},p.prototype.plugPosition=function(t){return new r.Point({x:this.x()+a.PLUG_OFFSET_X,y:this.y()+this.portListTop()+t.middle()})},p.prototype.socketPosition=function(t){return new r.Point({x:this.x()+a.SOCKET_OFFSET_X,y:this.y()+this.portListTop()+t.middle()})},p.prototype.port=function(t){return this.ports().filter(function(e){return e.name()===t})[0]||null},p.prototype.targetPort=function(t){return this.ports().filter(function(e){return r.contains(e.listItemElement(),t)})[0]||null},p.prototype.eventPorts=function(){return this.ports().filter(function(t){return t.type()===a.TYPE_EVENT})},p.prototype.visiblePorts=function(){return this.ports().filter(function(t){return t.visible()})},p.prototype.isAllPortsVisible=function(){return this.visiblePorts().length===this.ports().length},p.prototype.url=function(){return["modular_modules/",this.name().split("/").map(function(t){return encodeURIComponent(t)}).join("/"),".html"].join("")},p.prototype.props=function(){return{title:this.title(),name:this.name(),x:this.x(),y:this.y()}},p.prototype.visiblePortNames=function(){return this.visiblePorts().sort(function(t,e){return t.top()-e.top()}).map(function(t){return t.name()})},p.prototype.createPorts=function(){return this.circuitElement().getAll().map(function(t){
var e=t.props();return new a(o.extend(o.clone(e),{parentListElement:this.portListElement(),parentOptGroupElement:this.portOptGroupElement(e.type)}))}.bind(this))},p.prototype.createEventCircuitElement=function(){return new i(this.eventPorts().map(function(t){return{label:t.label(),name:t.name(),type:t.type(),arg:this.portEventer.bind(null,new l({module:this,port:t}))}}.bind(this)))},p.prototype.bindEventCircuitElement=function(){var t=this.eventCircuitElement();if(t){var e=this.circuitElement();t.getAll().forEach(function(t){i.bind(e.get(t.props().name),t)})}},p.prototype.unbindEventCircuitElement=function(){var t=this.eventCircuitElement();if(t){var e=this.circuitElement();t.getAll().forEach(function(t){i.unbind(e.get(t.props().name),t)})}},p.prototype.registerComponentPointListener=function(){r.on(this.componentContentWindow(),r.eventType("start"),this.onpoint,!0)},p.prototype.unregisterComponentPointListener=function(){r.off(this.componentContentWindow(),r.eventType("start"),this.onpoint,!0)},p.prototype.registerDragListener=function(){this.draggable=new r.Draggable({element:this.element(),onstart:p.prototype.onstart.bind(this),onmove:p.prototype.onmove.bind(this),onend:p.prototype.onend.bind(this)})},p.prototype.unregisterDragListener=function(){this.draggable.destroy(),this.draggable=null},p.prototype.registerPortSelectChangeListener=function(){r.on(this.portSelectElement(),"change",this.onchange)},p.prototype.unregisterPortSelectChangeListener=function(){r.off(this.portSelectElement(),"change",this.onchange)},p.prototype.registerPointListener=function(){r.on(this.element(),r.eventType("start"),this.onpoint,!0)},p.prototype.unregisterPointListener=function(){r.off(this.element(),r.eventType("start"),this.onpoint,!0)},p.prototype.registerMessageListener=function(t,e){var n=this.messageListenable;n.register(t,e),r.on(this.componentContentWindow(),"message",n.listener)},p.prototype.unregisterMessageListener=function(){var t=this.messageListenable;r.off(this.componentContentWindow(),"message",t.listener),t.unregister()},p.prototype.setComponentContent=function(t,e){r.name(this.componentContentWindow(),e),r.writeContent(this.componentElement(),t)},p.prototype.resetComponentHeight=function(){r.fillContentHeight(this.componentElement()),this.portListTop(r.offsetHeight(this.headerElement())+r.offsetHeight(this.componentElement())+1)},p.prototype.resetPortSelect=function(){this.ports().forEach(function(t){this.needsUpdatePortSelect(t)}.bind(this))},p.prototype.exportModularModule=function(){var t=function(t){return new i(t)};return function(){var e=r.global().app;e.ModularModule!==t&&(e.ModularModule=t)}}(),p.prototype.loadComponent=function(){return this.isLoading(!0),r.ajax({type:"GET",url:this.url()}).then(function(t){return this.exportModularModule(),this.setComponentContent(t,this.messageData()),Promise.race([new Promise(this.registerMessageListener.bind(this)),new Promise(function(t,e){setTimeout(e,3e4,new Error("Load timeout for content"))})])}.bind(this)).then(function(){this.unregisterMessageListener(),this.isLoading(!1),this.resetComponentHeight(),this.ports(this.createPorts()),this.resetPortSelect(),this.eventCircuitElement(this.createEventCircuitElement()),this.bindEventCircuitElement(),this.registerComponentPointListener()}.bind(this))["catch"](function(t){throw this.unregisterMessageListener(),this.isError(!0),t}.bind(this))},p.prototype.showPort=function(t){var e=this.port(t);if(e&&!e.visible()){var n=this.portListHeight();this.portListHeight(n+e.height()),e.top(n),e.visible(!0),this.needsUpdatePortSelect(e),this.x()<a.SOCKET_WIDTH&&this.hasVisiblePortSocket()&&this.x(a.SOCKET_WIDTH),this.portToggler(new l({module:this,port:e}))}},p.prototype.hidePort=function(t){var e=this.port(t);if(e&&e.visible()){var n=this.visiblePorts().sort(function(t,e){return t.top()-e.top()});e.visible(!1),this.needsUpdatePortSelect(e),n.slice(n.indexOf(e)+1).forEach(function(t){t.top(t.top()-e.height())}),this.portListHeight(this.portListHeight()-e.height()),this.portToggler(new l({module:this,port:e}))}},p.prototype.needsUpdatePortSelect=function(t){var e=this.cache();e.toggledPorts||(e.toggledPorts=[]),-1===e.toggledPorts.indexOf(t)&&e.toggledPorts.push(t)},p.prototype["delete"]=function(){this.ports().forEach(function(t){this.hidePort(t.name())}.bind(this)),this.parentElement(null),this.deleter(this)},p.prototype.render=function(){var t=r.el("<div>");return r.addClass(t,"module"),r.html(t,p.TEMPLATE_HTML),t},p.prototype.redraw=function(){var t=this.element(),e=this.parentElement();if(e||t){if(e&&!t)return this.element(this.render()),this.registerDragListener(),this.registerPortSelectChangeListener(),this.registerPointListener(),this.redraw(),void r.append(e,this.element());if(!e&&t)return this.unregisterDragListener(),this.unregisterPortSelectChangeListener(),this.unregisterPointListener(),this.unbindEventCircuitElement(),this.unregisterComponentPointListener(),r.remove(t),this.element(null),void this.cache({});this.redrawTitle(),this.redrawPosition(),this.redrawZIndex(),this.redrawDeletable(),this.redrawPortList(),this.redrawFooter(),this.redrawPortSelect(),this.redrawToggleClasses()}},p.prototype.redrawTitle=function(){var t=this.title(),e=this.cache();t!==e.title&&(r.text(this.titleElement(),t),e.title=t)},p.prototype.redrawPosition=function(){var t=this.x(),e=this.y(),n=this.cache();t===n.x&&e===n.y||(r.translate(this.element(),t,e),n.x=t,n.y=e)},p.prototype.redrawZIndex=function(){var t=this.zIndex(),e=this.cache();t!==e.zIndex&&(r.css(this.element(),{zIndex:t}),e.zIndex=t)},p.prototype.redrawDeletable=function(){var t=this.deletable(),e=this.cache();t!==e.deletable&&(r.toggleClass(this.element(),"module-delete-disabled",!t),e.deletable=t)},p.prototype.redrawPortList=function(){var t=this.portListHeight(),e=this.cache();t!==e.portListHeight&&(r.css(this.portListElement(),{height:t+"px"}),e.portListHeight=t)},p.prototype.redrawFooter=function(){var t=this.isAllPortsVisible(),e=this.cache();t!==e.isAllPortsVisible&&(r.toggleClass(this.footerElement(),"hide",t),e.isAllPortsVisible=t)},p.prototype.redrawPortSelect=function(){var t=this.cache(),e=t.toggledPorts;e&&(e.forEach(function(t){t.redraw()}),[a.TYPE_PROP,a.TYPE_EVENT].forEach(function(t){r.sort(this.portOptGroupElement(t))}.bind(this)),r.value(this.portSelectElement(),""),t.toggledPorts=null)},p.prototype.redrawToggleClasses=function(){this.redrawToggleClass("isLoading","module-loading"),this.redrawToggleClass("isError","module-error"),this.redrawToggleClass("isMoving","module-moving"),this.redrawToggleClass("isDeleting","module-deleting")},p.prototype.dragType=function(t){return t===this.titleElement()?p.DRAG_TYPE_POSITION:t===this.deleteButtonElement()?p.DRAG_TYPE_DELETE:r.hasClass(t,"module-port-hide-button")?p.DRAG_TYPE_HIDE_PORT:r.hasClass(t,"module-port-label")?p.DRAG_TYPE_SORT_PORT:r.hasClass(t,"module-port-plug")?p.DRAG_TYPE_DRAG_PORT_PLAG:r.hasClass(r.parent(t),"module-port-socket")?p.DRAG_TYPE_DRAG_PORT_SOCKET:null},p.prototype.onstart=function(t,e,n,o){var i=this.dragType(r.target(n));o.type=i,i&&(r.cancel(n),p.DRAG_LISTENERS[i].onstart.call(this,t,e,n,o),this.dragStarter())},p.prototype.onmove=function(t,e,n,o){var r=o.type;r&&p.DRAG_LISTENERS[r].onmove.call(this,t,e,n,o)},p.prototype.onend=function(t,e,n,o){var r=o.type;r&&(p.DRAG_LISTENERS[r].onend.call(this,t,e,n,o),this.dragEnder())},p.prototype.onmessage=function(t){if(t.origin!==r.origin())throw new Error("Invalid content origin");if(t.data!==this.messageData())throw new Error("Invalid content data");if(!this.circuitElement())throw new Error("Invalid circuit element")},p.prototype.onchange=function(t){this.showPort(r.value(r.target(t))),r.removeFocus()},p.prototype.onpoint=function(){this.fronter(this)},p.DRAG_TYPE_POSITION="position",p.DRAG_TYPE_DELETE="delete",p.DRAG_TYPE_HIDE_PORT="hidePort",p.DRAG_TYPE_SORT_PORT="sortPort",p.DRAG_TYPE_DRAG_PORT_PLAG="dragPortPlug",p.DRAG_TYPE_DRAG_PORT_SOCKET="dragPortSocket",p.DRAG_TYPE_POSITION_LISTENER={onstart:function(t,e,n,o){o.x=this.x(),o.y=this.y(),this.isMoving(!0)},onmove:function(t,e,n,o){this.x(Math.max(o.x+t,this.hasVisiblePortSocket()?a.SOCKET_WIDTH:0)),this.y(Math.max(o.y+e,0))},onend:function(t,e,n,o){this.isMoving(!1)}},p.DRAG_TYPE_DELETE_LISTENER={onstart:function(t,e,n,o){o.target=r.target(n),this.isDeleting(!0)},onmove:function(t,e,n,o){this.isDeleting(r.target(n)===o.target)},onend:function(t,e,n,o){this.isDeleting(!1),r.target(n)===o.target&&this["delete"]()}},p.DRAG_TYPE_HIDE_PORT_LISTENER={onstart:function(t,e,n,o){o.target=r.target(n),o.port=this.targetPort(o.target)},onmove:function(){},onend:function(t,e,n,o){r.target(n)===o.target&&this.hidePort(o.port.name())}},p.DRAG_TYPE_SORT_PORT_LISTENER={onstart:function(t,e,n,o){var i=this.targetPort(r.target(n)),s=i.top();o.port=i,o.top=s,o.placeholderTop=s,i.isMoving(!0)},onmove:function(t,e,n,r){var i=r.port;i.top(o.clamp(r.top+e,0,this.portListHeight()-i.height())),i.top()-r.placeholderTop>0?p.DRAG_TYPE_SORT_PORT_LISTENER.onmovedown.call(this,t,e,n,r):p.DRAG_TYPE_SORT_PORT_LISTENER.onmoveup.call(this,t,e,n,r)},onmovedown:function(t,e,n,o){var r=o.port,i=r.height(),s=r.middle(),a=o.placeholderTop;this.visiblePorts().filter(function(t){var e=t.top();return t!==r&&e>=a&&s>e}).forEach(function(t){t.top(t.top()-i),a=Math.max(a,t.bottom())}),o.placeholderTop=a},onmoveup:function(t,e,n,o){var r=o.port,i=r.height(),s=r.middle(),a=o.placeholderTop;this.visiblePorts().filter(function(t){var e=t.bottom();return t!==r&&e>s&&a>=e}).forEach(function(t){var e=t.top();t.top(e+i),a=Math.min(a,e)}),o.placeholderTop=a},onend:function(t,e,n,o){var r=o.port;r.top(o.placeholderTop),r.isMoving(!1)}},p.DRAG_TYPE_DRAG_PORT_PLAG_LISTENER={onstart:function(t,e,n,o){var i=this.targetPort(r.target(n));o.unit=new l({module:this,port:i}),o.context={},this.dragPortPlugStarter(o.unit,o.context)},onmove:function(t,e,n,o){this.dragPortPlugMover(o.unit,t,e,o.context)},onend:function(t,e,n,o){this.dragPortPlugEnder(o.unit,o.context)}},p.DRAG_TYPE_DRAG_PORT_SOCKET_LISTENER={onstart:function(t,e,n,o){var i=this.targetPort(r.target(n));o.unit=new l({module:this,port:i}),o.context={},this.dragPortSocketStarter(o.unit,o.context)},onmove:function(t,e,n,o){this.dragPortSocketMover(o.unit,t,e,o.context)},onend:function(t,e,n,o){this.dragPortSocketEnder(o.unit,o.context)}},p.DRAG_LISTENERS=function(){var t={};return t[p.DRAG_TYPE_POSITION]=p.DRAG_TYPE_POSITION_LISTENER,t[p.DRAG_TYPE_DELETE]=p.DRAG_TYPE_DELETE_LISTENER,t[p.DRAG_TYPE_HIDE_PORT]=p.DRAG_TYPE_HIDE_PORT_LISTENER,t[p.DRAG_TYPE_SORT_PORT]=p.DRAG_TYPE_SORT_PORT_LISTENER,t[p.DRAG_TYPE_DRAG_PORT_PLAG]=p.DRAG_TYPE_DRAG_PORT_PLAG_LISTENER,t[p.DRAG_TYPE_DRAG_PORT_SOCKET]=p.DRAG_TYPE_DRAG_PORT_SOCKET_LISTENER,t}(),p.TEMPLATE_HTML=['<div class="module-header">','<div class="module-header-title"></div>','<div class="module-header-delete-button"></div>',"</div>",'<div class="module-content">','<iframe class="module-component"></iframe>','<div class="module-port-list"></div>',"</div>",'<div class="module-footer">','<img class="module-footer-icon" src="images/caret-down.svg">','<select class="module-port-select">','<optgroup label="Property"></optgroup>','<optgroup label="Event"></optgroup>',"</select>","</div>"].join(""),"undefined"!=typeof e&&e.exports?e.exports=p:n.Module=p}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"../models/circuit-element.js":16,"../models/module-unit.js":17,"./component.js":4,"./module-port.js":8}],11:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.Component||t("./component.js"),s=o.inherits(function(t){s.super_.call(this,t),this.title=this.prop(t.title),this.content=this.prop(t.content),this.name=this.prop(t.name),this.parentElement=this.prop(null),this.draggable=null,this.dragStarter=t.dragStarter,this.dragEnder=t.dragEnder,this.dropper=t.dropper},i);s.prototype.headerElement=function(){return r.child(this.element(),0)},s.prototype.contentElement=function(){return r.child(this.element(),1)},s.prototype.registerDragListener=function(){this.draggable=new r.Draggable({element:this.element(),onstart:s.prototype.onstart.bind(this),onmove:s.prototype.onmove.bind(this),onend:s.prototype.onend.bind(this)})},s.prototype.unregisterDragListener=function(){this.draggable.destroy(),this.draggable=null},s.prototype.makeCloneElement=function(){var t=r.clone(this.element());return r.addClass(t,"clone"),t},s.prototype["delete"]=function(){this.parentElement(null)},s.prototype.render=function(){var t=r.el("<div>");return r.addClass(t,"module"),r.html(t,s.TEMPLATE_HTML),t},s.prototype.redraw=function(){var t=this.element(),e=this.parentElement();if(e||t){if(e&&!t)return this.element(this.render()),this.registerDragListener(),this.redraw(),void r.append(e,this.element());if(!e&&t)return this.unregisterDragListener(),r.remove(t),this.element(null),void this.cache({});this.redrawTitle(),this.redrawContent()}},s.prototype.redrawTitle=function(){var t=this.title(),e=this.cache();t!==e.title&&(r.text(this.headerElement(),t),e.title=t)},s.prototype.redrawContent=function(){var t=this.content(),e=this.cache();t!==e.content&&(r.text(this.contentElement(),t),e.content=t)},s.prototype.onstart=function(t,e,n,o){var i=function(){var t=this.makeCloneElement(),e=r.rect(this.element()),n=e.left+r.scrollX(),i=e.top+r.scrollY();r.translate(t,n,i),r.append(r.body(),t),o.cloneElement=t,o.left=n,o.top=i,o.timer=null,this.dragStarter()}.bind(this);r.supportsTouch()?(o.cloneElement=null,o.timer=setTimeout(i,300)):(r.cancel(n),i())},s.prototype.onmove=function(t,e,n,o){o.cloneElement?r.translate(o.cloneElement,o.left+t,o.top+e):o.timer&&(Math.abs(t)>5||Math.abs(e)>5)&&(clearTimeout(o.timer),o.timer=null)},s.prototype.onend=function(t,e,n,o){var i=o.cloneElement;if(i){var s=r.rect(i);r.remove(i),this.dragEnder(),this.dropper(this.name(),s.left,s.top)}else o.timer&&(clearTimeout(o.timer),o.timer=null)},s.TEMPLATE_HTML=['<div class="module-header"></div>','<div class="module-content"></div>'].join(""),"undefined"!=typeof e&&e.exports?e.exports=s:n.SidebarModule=s}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"./component.js":4}],12:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),i=n.Button||t("./button.js"),s=o.inherits(function(t){s.super_.call(this,t),this.type=this.prop(s.TYPE_COLLAPSE),this.collapser=t.collapser,this.expander=t.expander},i);s.prototype.toggler=function(){var t={collapse:"collapser",expand:"expander"};return function(){return this[t[this.type()]]()}}(),s.prototype.switchType=function(){var t={collapse:"expand",expand:"collapse"};return function(){this.type(t[this.type()])}}(),s.prototype.redraw=function(){s.super_.prototype.redraw.call(this),this.redrawType()},s.prototype.redrawType=function(){var t=this.type(),e=this.cache();t!==e.type&&(r.data(this.element(),"type",t),e.type=t)},s.prototype.ontap=function(){this.disabled(!0),this.toggler().then(function(){this.switchType(),this.disabled(!1)}.bind(this))["catch"](function(){this.disabled(!1)}.bind(this))},s.TYPE_COLLAPSE="collapse",s.TYPE_EXPAND="expand","undefined"!=typeof e&&e.exports?e.exports=s:n.SidebarToggleButton=s}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"./button.js":3}],13:[function(t,e,n){!function(n){"use strict";var o=t("iscroll"),r=n.helper||t("../helper.js"),i=n.dom||t("../dom.js"),s=n.Component||t("./component.js"),a=n.SidebarModule||t("./sidebar-module.js"),l=n.SidebarRelation||t("../relations/sidebar-relation.js"),p=r.inherits(function(t){p.super_.call(this,t),this.disabled=this.prop(!0),this.registerSearchInputFocusListener(),this.registerSearchInputInputListener()},s);p.prototype.searchInputElement=function(){return i.child(this.element(),0)},p.prototype.searchText=function(){return i.value(this.searchInputElement())},p.prototype.registerSearchInputFocusListener=function(){var t=this.searchInputElement(),e=i.isFocused(t);i.on(t,i.eventType("start"),function(){e=i.isFocused(t)}),i.on(t,"click",function(){e||i.hasSelection(t)||i.selectAll(t)})},p.prototype.registerSearchInputInputListener=function(){i.on(this.searchInputElement(),"input",function(){this.markDirty()}.bind(this))},p.prototype.redraw=function(){this.redrawDisabled()},p.prototype.redrawDisabled=function(){var t=this.cache(),e=this.disabled();e!==t.disabled&&(i.disabled(this.searchInputElement(),e),t.disabled=e)};var h=r.inherits(function(t){h.super_.call(this,t),this.modules=this.prop([]),this.scrollable=new o(this.element(),{disableMouse:!0,disablePointer:!0,fadeScrollbars:i.supportsTouch(),interactiveScrollbars:!i.supportsTouch(),mouseWheel:!0,scrollbars:!0}),this.dragStarter=t.dragStarter,this.dragEnder=t.dragEnder,this.dropper=t.dropper,i.on(this.element(),i.eventType("start"),h.prototype.onpoint.bind(this))},s);h.prototype.scrollerElement=function(){return i.child(this.element(),0)},h.prototype.createModule=function(t){return new a(r.extend(r.clone(t),{dragStarter:this.dragStarter,dragEnder:this.dragEnder,dropper:this.dropper}))},h.prototype.appendModule=function(t){var e=this.createModule(t);this.modules().push(e),e.parentElement(this.scrollerElement()),this.markDirty()},h.prototype.clear=function(){this.modules().forEach(function(t){t["delete"]()}),this.modules([])},h.prototype.setModules=function(t){this.clear(),t.forEach(function(t){this.appendModule({title:t.label,content:t.description,name:t.key()})}.bind(this))},h.prototype.scrollEnabled=function(t){t?this.scrollable.enable():this.scrollable.disable()},h.prototype.redraw=function(){setTimeout(function(){this.scrollable.refresh()}.bind(this),0)},h.prototype.onpoint=function(){i.removeFocus()};var u=r.inherits(function(t){u.super_.call(this,t),this.dragCount=this.prop(0),this.header=new p({element:this.headerElement()}),this.content=new h({element:this.contentElement(),dragStarter:u.prototype.dragStarter.bind(this),dragEnder:u.prototype.dragEnder.bind(this),dropper:t.moduleDropper}),this.relation=new l({header:this.header,content:this.content,moduleEntrySearcher:t.moduleEntrySearcher}),this.moduleDragStarter=t.moduleDragStarter,this.moduleDragEnder=t.moduleDragEnder,this.header.relations().push(this.relation)},s);u.prototype.headerElement=function(){return i.child(this.element(),0)},u.prototype.contentElement=function(){return i.child(this.element(),1)},u.prototype.incrementDragCount=function(){this.dragCount(this.dragCount()+1)},u.prototype.decrementDragCount=function(){this.dragCount(this.dragCount()-1)},u.prototype.searchEnabled=function(t){this.header.disabled(!t)},u.prototype.redraw=function(){this.redrawDragCount()},u.prototype.redrawDragCount=function(){var t=this.dragCount(),e=this.cache();t!==e.dragCount&&(this.content.scrollEnabled(0===t),e.dragCount=t)},u.prototype.dragStarter=function(){this.incrementDragCount(),this.moduleDragStarter()},u.prototype.dragEnder=function(){this.decrementDragCount(),this.moduleDragEnder()},"undefined"!=typeof e&&e.exports?e.exports=u:n.Sidebar=u}(this.app||(this.app={}))},{"../dom.js":14,"../helper.js":15,"../relations/sidebar-relation.js":19,"./component.js":4,"./sidebar-module.js":11,iscroll:void 0}],14:[function(t,e,n){(function(n){!function(o){"use strict";var r=o.helper||t("./helper.js"),i={};i.unsupported=function(){return"undefined"==typeof document},i.global=function(){return"undefined"!=typeof e&&e.exports?n:window},i.el=function(t){return"<"===t.charAt(0)?(t=t.match(/<(.+)>/)[1],document.createElement(t)):document.querySelector(t)},i.body=function(){return document.body},i.append=function(t,e){t.appendChild(e)},i.remove=function(t){var e=t.parentNode;e&&e.removeChild(t)},i.child=function(t,e){var n=arguments.length;if(2===n)return t.children[e];for(var o=1;n>o;o++)e=arguments[o],t=t.children[e];return t},i.childNode=function(t,e){var n=arguments.length;if(2===n)return t.childNodes[e];for(var o=1;n>o;o++)e=arguments[o],t=t.childNodes[e];return t},i.children=function(t){return Array.prototype.slice.call(t.children)},i.parent=function(t){return t.parentNode},i.contains=function(t,e){return t.contains(e)},i.attr=function(t,e){for(var n in e)t.setAttribute(n,e[n])},i.css=function(t,e){var n=t.style;for(var o in e)n[o]=e[o]},i.addClass=function(t,e){t.classList.add(e)},i.removeClass=function(t,e){t.classList.remove(e)},i.toggleClass=function(t,e,n){return"undefined"==typeof n?void t.classList.toggle(e):void(n?t.classList.add(e):t.classList.remove(e))},i.hasClass=function(t,e){return t.classList.contains(e)},i.data=function(t,e,n){return"undefined"==typeof n?t.dataset[e]:null===n?void(e in t.dataset&&delete t.dataset[e]):void(t.dataset[e]=n)},i.name=function(t,e){t.name=e},i.text=function(t,e){t.textContent=e},i.html=function(t,e){t.innerHTML=e},i.value=function(t,e){return"undefined"==typeof e?t.value:void(t.value=e)},i.hasSelection=function(t){return t.selectionStart!==t.selectionEnd},i.selectAll=function(t){t.setSelectionRange(0,9999)},i.disabled=function(t,e){t.disabled=e},i.rect=function(t){return t.getBoundingClientRect()},i.offsetHeight=function(t){return t.offsetHeight},i.scrollLeft=function(t){return t.scrollLeft},i.scrollTop=function(t){return t.scrollTop},i.scrollX=function(){return window.pageXOffset},i.scrollY=function(){return window.pageYOffset},i.contentWindow=function(t){return t.contentWindow},i.writeContent=function(t,e){var n=t.contentDocument;n.open(),n.write(e),n.close()},i.fillContentHeight=function(t){t.style.height=t.contentDocument.documentElement.scrollHeight+"px"},i.isFocused=function(t){return t===document.activeElement},i.removeFocus=function(){document.activeElement.blur()},i.sort=function(t){r.sortBy(i.children(t),"textContent").forEach(function(e){i.append(t,e)})},i.clone=function(t){return t.cloneNode(!0)},i.translate=function(t,e,n){var o="translate("+e+"px, "+n+"px)";i.css(t,{transform:o,webkitTransform:o})},i.translateY=function(t,e){var n="translateY("+e+"px)";i.css(t,{transform:n,webkitTransform:n})},i.animate=function(t){return window.requestAnimationFrame(t)},i.on=function(t,e,n,o){t.addEventListener(e,n,!!o)},i.off=function(t,e,n,o){t.removeEventListener(e,n,!!o)},i.ready=function(t){document.addEventListener("DOMContentLoaded",t)},i.transition=function(t,e){return new Promise(function(n,o){var r=function(){i.off(t,"transitionend",r),n()};i.on(t,"transitionend",r),e()})},i.supportsTouch=function(){return"createTouch"in document},i.target=function(t){return i.supportsTouch()&&"changedTouches"in t?(t=t.changedTouches[0],document.elementFromPoint(t.clientX,t.clientY)):t.target},i.cancel=function(t){t.preventDefault()},i.eventType=function(t){var e=i.supportsTouch();switch(t){case"start":return e?"touchstart":"mousedown";case"move":return e?"touchmove":"mousemove";case"end":return e?"touchend":"mouseup";default:throw new Error("Invalid error type")}},i.Point=function(){var t=function(t){this.x=t.x,this.y=t.y};return t.prototype.equal=function(t){return this.x===t.x&&this.y===t.y},t}(),i.pagePoint=function(t,e){return i.supportsTouch()&&(t=t.changedTouches[0]),new i.Point({x:t.pageX-(e?e.x:0),y:t.pageY-(e?e.y:0)})},i.clientPoint=function(t,e){return i.supportsTouch()&&(t=t.changedTouches[0]),new i.Point({x:t.clientX-(e?e.x:0),y:t.clientY-(e?e.y:0)})},i.identifier=function(t){return i.supportsTouch()?t.changedTouches[0].identifier:null},i.Draggable=function(){var t=function(t){this.element=t.element,this.onstart=t.onstart,this.onmove=t.onmove,this.onend=t.onend,this.start=e.bind(this),this.move=n.bind(this),this.end=o.bind(this),this.lock=!1,this.identifier=null,this.startingPoint=null,this.context={},i.on(this.element,i.eventType("start"),this.start)};t.prototype.destroy=function(){i.off(this.element,i.eventType("start"),this.start),i.off(document,i.eventType("move"),this.move),i.off(document,i.eventType("end"),this.end),this.context=null};var e=function(t){if(!this.lock){this.lock=!0,this.identifier=i.identifier(t),this.startingPoint=i.pagePoint(t);var e=this.onstart;if("function"==typeof e){var n=this.element,o=i.rect(n),r=i.clientPoint(t,{x:o.left-i.scrollLeft(n),y:o.top-i.scrollTop(n)});e(r.x,r.y,t,this.context)}i.on(document,i.eventType("move"),this.move),i.on(document,i.eventType("end"),this.end)}},n=function(t){var e=this.identifier;if(!e||e===i.identifier(t)){var n=this.onmove;if("function"==typeof n){var o=i.pagePoint(t,this.startingPoint);n(o.x,o.y,t,this.context)}}},o=function(t){var e=this.identifier;if(!e||e===i.identifier(t)){i.off(document,i.eventType("move"),this.move),i.off(document,i.eventType("end"),this.end);var n=this.onend;if("function"==typeof n){var o=i.pagePoint(t,this.startingPoint);n(o.x,o.y,t,this.context)}this.lock=!1}};return t}(),i.load=function(t){return new Promise(function(e,n){var o=new FileReader,r=function(){n(new Error("Failed to load file: "+t.name))};o.onload=function(t){e(t.target.result)},o.onerror=r,o.onabort=r,o.readAsText(t)})},i.ajax=function(t){var e=t.type,n=t.url;return new Promise(function(t,o){var r=new XMLHttpRequest,i=function(){o(new Error("Failed to load resource: "+e+" "+n))};r.onload=function(){r.status>=200&&r.status<400?t(r.responseText):i()},r.onerror=i,r.onabort=i,r.open(e,n,!0),r.send()})},i.origin=function(){return location.protocol+"//"+location.host},i.Listenable=function(){var t=function(e){this.callback=e.callback,this.resolve=null,this.reject=null,this.listener=t.prototype.listener.bind(this)};return t.prototype.register=function(t,e){this.resolve=t,this.reject=e},t.prototype.unregister=function(){this.resolve=null,this.reject=null},t.prototype.listener=function(t){try{this.callback(t),this.resolve()}catch(e){this.reject(e)}},t}(),"undefined"!=typeof e&&e.exports?e.exports=i:o.dom=i}(this.app||(this.app={}))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./helper.js":15}],15:[function(t,e,n){!function(t){"use strict";var n={};n.randomString=function(t){for(var e=[],n=0,o=Math.floor(t/7);o>n;n++)e.push(Math.random().toString(36).slice(-7));var r=t%7;return r&&e.push(Math.random().toString(36).slice(-r)),e.join("")},n.clamp=function(t,e,n){return Math.min(Math.max(t,e),n)},n.inherits=function(t,e){return t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),t},n.identity=function(t){return t},n.equal=function(t,e){return null!=t&&"function"==typeof t.equal?t.equal(e):t===e},n.values=function(t){return Object.keys(t).map(function(e){return t[e]})},n.clone=function(t){var e={};for(var n in t)e[n]=t[n];return e},n.extend=function(t){for(var e=1,n=arguments.length;n>e;e++){var o=arguments[e];for(var r in o)t[r]=o[r]}return t},n.pick=function(t,e){var n={};return t?(e.forEach(function(e){e in t&&(n[e]=t[e])}),n):n},n.dig=function(){var t=Array.prototype.slice.call(arguments);return t.reduce(function(t,e){return"object"==typeof t?t[e]:null})},n.sortBy=function(t,e){return t.slice().sort(function(t,n){var o="function"==typeof e?e(t):t[e],r="function"==typeof e?e(n):n[e];return o>r?1:r>o?-1:0})},n.remove=function(t,e){t.splice(t.indexOf(e),1)},n.moveToBack=function(t,e){var n=t.indexOf(e);-1!==n&&(t.splice(n,1),t.push(e))},n.findIndex=function(t,e){for(var n=0,o=t.length;o>n;n++)if(e(t[n],n,t))return n;return-1},n.Set=function(){var t=function(){this.data=[]};return t.prototype.add=function(t){this.has(t)||this.data.push(t)},t.prototype["delete"]=function(t){for(var e=this.data,o=e.length-1;o>=0;o--)if(n.equal(e[o],t)){e.splice(o,1);break}},t.prototype.has=function(t){return this.data.some(function(e){return n.equal(e,t)})},t.prototype.toArray=function(){return this.data.slice()},t}(),n.Map=function(){var t=function(){this.data=[]};return t.prototype.set=function(t,e){var o=this.data;if(!this.has(t))return void o.push([t,e]);for(var r=o.length-1;r>=0;r--){var i=o[r];if(n.equal(i[0],t)){i[1]=e;break}}},t.prototype.get=function(t){var e=this.data.filter(function(e){return n.equal(e[0],t)})[0];return e?e[1]:null},t.prototype["delete"]=function(t){for(var e=this.data,o=e.length-1;o>=0;o--)if(n.equal(e[o][0],t)){e.splice(o,1);break}},t.prototype.has=function(t){return this.data.some(function(e){return n.equal(e[0],t)})},t.prototype.forEach=function(t){this.data.forEach(function(e){t(e[1],e[0],this)}.bind(this))},t}(),"undefined"!=typeof e&&e.exports?e.exports=n:t.helper=n}(this.app||(this.app={}))},{}],16:[function(t,e,n){!function(n){"use strict";var o=t("circuit"),r=n.helper||t("../helper.js"),i=function(t,e){return t.unwrap=i.unwrap.bind(e),t};i.unwrap=function(t){return t===i.KEY?this:void 0},i.KEY={};var s=function(t){return this.callee=o[t.type](t.arg),this.wrapper(r.extend(this.defaults(),r.pick(t,s.KEYS)))};s.prototype.defaults=function(){return{socketDisabled:!1,plugDisabled:!1}},s.prototype.call=function(){return this.callee.apply(null,arguments)},s.prototype.wrapper=function(t){var e=new i(s.prototype.call.bind(this),this);return e.props=r.clone.bind(null,t),e},s.KEYS=["label","name","type","socketDisabled","plugDisabled"];var a=function(t){var e={},n=[];return t.slice().reverse().forEach(function(t){var o=t.name;o in e||(e[o]=new s(t),n.unshift(o))}),this.memberTable=e,this.memberNames=n,this.wrapper()};a.prototype.get=function(t){return this.memberTable[t]},a.prototype.getAll=function(){return this.memberNames.map(function(t){return this.get(t)}.bind(this))},a.prototype.wrapper=function(){return{get:a.prototype.get.bind(this),getAll:a.prototype.getAll.bind(this)}},a.bind=function(t,e){var n=t.unwrap(i.KEY),r=e.unwrap(i.KEY);o.bind(n.callee,r.callee)},a.unbind=function(t,e){var n=t.unwrap(i.KEY),r=e.unwrap(i.KEY);o.unbind(n.callee,r.callee)},"undefined"!=typeof e&&e.exports?e.exports=a:n.CircuitElement=a}(this.app||(this.app={}))},{"../helper.js":15,circuit:void 0}],17:[function(t,e,n){!function(n){"use strict";var o=n.helper||t("../helper.js"),r=function(t){this.module=t.module,this.port=t.port};r.prototype.equal=function(t){return t?Object.keys(this).every(function(e){return o.equal(this[e],t[e])}.bind(this)):!1},r.prototype.contains=function(t){return Object.keys(this).some(function(e){return o.equal(this[e],t)}.bind(this))},r.prototype.portName=function(){return this.port.name()},r.prototype.portType=function(){return this.port.type()},r.prototype.portPlugDisabled=function(){return this.port.plugDisabled()},r.prototype.portSocketDisabled=function(){return this.port.socketDisabled()},r.prototype.portVisible=function(){return this.port.visible()},r.prototype.portSocketConnected=function(t){return this.port.socketConnected(t)},r.prototype.portPlugHighlighted=function(t){return this.port.plugHighlighted(t)},r.prototype.portSocketHighlighted=function(t){return this.port.socketHighlighted(t)},r.prototype.circuitElementMember=function(){return this.module.circuitElementMember(this.port.name())},r.prototype.plugPosition=function(){return this.module.plugPosition(this.port)},r.prototype.socketPosition=function(){return this.module.socketPosition(this.port)},r.prototype.labelHighlighted=function(t){this.port.labelHighlighted(t),this.module.deletable(this.module.ports().every(function(t){return!t.labelHighlighted()}))},r.prototype.addRelation=function(t){this.module.relations().push(t),this.port.relations().push(t)},r.prototype.removeRelation=function(t){o.remove(this.module.relations(),t),o.remove(this.port.relations(),t)},r.fromModuleAndPortName=function(t,e){if(!t)return null;var n=t.port(e);return n?new r({module:t,port:n}):null},"undefined"!=typeof e&&e.exports?e.exports=r:n.ModuleUnit=r}(this.app||(this.app={}))},{"../helper.js":15}],18:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),r=n.helper||t("../helper.js"),i=r.inherits(function(t){this.type=t.type,this.unit=t.unit,this.wire=t.wire},o.Relation);i.prototype.positionType=function(){var t={plug:"source",socket:"target"};return function(){return t[this.type]}}(),i.prototype.equal=function(t){return t?Object.keys(this).every(function(e){return r.equal(this[e],t[e]);
}.bind(this)):!1},i.prototype.update=function(){var t=this.wire,e=this.positionType(),n=this.unit[this.type+"Position"]();t[e+"X"](n.x),t[e+"Y"](n.y)},i.TYPE_PLUG="plug",i.TYPE_SOCKET="socket","undefined"!=typeof e&&e.exports?e.exports=i:n.LockRelation=i}(this.app||(this.app={}))},{"../helper.js":15,jcore:void 0}],19:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),r=n.helper||t("../helper.js"),i=r.inherits(function(t){this.header=t.header,this.content=t.content,this.moduleEntrySearcher=t.moduleEntrySearcher},o.Relation);i.prototype.moduleEntries=function(){return this.moduleEntrySearcher(this.header.searchText())},i.prototype.update=function(){this.content.setModules(this.moduleEntries())},"undefined"!=typeof e&&e.exports?e.exports=i:n.SidebarRelation=i}(this.app||(this.app={}))},{"../helper.js":15,jcore:void 0}]},{},[1]);